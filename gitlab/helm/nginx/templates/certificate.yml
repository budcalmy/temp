{{- $env := .Values.env | default "dev" }}
{{- $host := .Values.host | default "nginx.webhop.me" }}
{{- $namespace := .Values.namespace | default "default" }}
{{- $appName := .Values.names.app | default (printf "%s-nginx" $env) }}
{{- $certificateName := .Values.names.certificate | default (printf "%s-certificate" $appName) }}
{{- $tlsSecretName := .Values.names.tlsSecret | default (printf "%s-tls-secret" $appName) }}
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: {{ $certificateName }}
  namespace: {{ $namespace }}
spec:
  secretName: {{ $tlsSecretName }}
  issuerRef:
    name: letsencrypt-prod
    kind: ClusterIssuer
  commonName: {{ $host }}
  dnsNames:
  - {{ $host }}
